---
import PageLayout from "@/layouts/Base";
import { getAllProjects } from "@/lib/projects.data";
import { getTagSlug, formatTagForDisplay } from "@/utils";

const projects = await getAllProjects();

const meta = {
  title: "Projects",
  description: "A collection of tools, experiments, and work in progress",
};
export const prerender = true;
---

<PageLayout meta={meta}>
  <div class="projects-page">
    <header class="projects-header">
      <h1 class="projects-title">
        <span class="title-decorator" aria-hidden="true">&lt;</span>
        Projects
        <span class="title-decorator" aria-hidden="true">/&gt;</span>
      </h1>
      <p class="projects-subtitle">A collection of tools, experiments, and work in progress</p>
    </header>

    <div class="projects-grid">
      {projects.map((project, index) => (
        <article class="project-card neon-card" style={`animation-delay: ${index * 0.08}s`}>
          <div class="card-glow" aria-hidden="true"></div>
          <div class="project-content">
            <div class="project-header">
              <h2 class="project-title">
                <a
                  href={project.url || `/projects/${project.slug}`}
                  {...(project.url ? { target: "_blank", rel: "noopener noreferrer" } : {})}
                >
                  {project.title}
                  {project.url && (
                    <>
                      <span class="external-icon" aria-hidden="true">&#8599;</span>
                      <span class="sr-only">(opens in new tab)</span>
                    </>
                  )}
                </a>
              </h2>
              <div class="project-meta">
                <span class="project-category neon-tag-cyan">{formatTagForDisplay(project.category)}</span>
                <span class="project-status">{formatTagForDisplay(project.status)}</span>
              </div>
            </div>
            <p class="project-description">{project.description}</p>
            {project.tags && project.tags.length > 0 && (
              <div class="project-tags">
                {project.tags.map((tag) => (
                  <a href={`/projects/tags/${getTagSlug(tag)}`} class="neon-tag" title={`View projects with tag: ${formatTagForDisplay(tag)}`}>
                    {formatTagForDisplay(tag)}
                  </a>
                ))}
              </div>
            )}
            {project.technologies && project.technologies.length > 0 && (
              <div class="project-technologies">
                {project.technologies.map((tech) => (
                  <span class="technology-tag">{tech}</span>
                ))}
              </div>
            )}
          </div>
        </article>
      ))}
    </div>
  </div>

  <style>
    .projects-page {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }

    .projects-header {
      text-align: center;
      margin-bottom: 3rem;
      position: relative;
      padding-bottom: 2rem;
    }

    .projects-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 250px;
      height: 2px;
      background: linear-gradient(
        90deg,
        transparent,
        var(--neon-cyan),
        var(--neon-pink),
        var(--neon-cyan),
        transparent
      );
      box-shadow: 0 0 10px var(--neon-cyan);
    }

    .projects-title {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      color: var(--neon-cyan);
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 3px;
      text-shadow:
        0 0 10px var(--neon-cyan),
        0 0 20px var(--neon-cyan),
        0 0 40px rgba(0, 217, 255, 0.5);
    }

    .title-decorator {
      color: var(--neon-pink);
      text-shadow:
        0 0 10px var(--neon-pink),
        0 0 20px var(--neon-pink);
    }

    .projects-subtitle {
      font-size: 1.1rem;
      color: var(--theme-quote);
      font-style: italic;
      margin: 0;
    }

    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1.5rem;
    }

    .project-card {
      border-radius: 12px;
      overflow: hidden;
      position: relative;
      opacity: 0;
      animation: fade-in 0.5s ease-out forwards;
    }

    @keyframes fade-in {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .card-glow {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--neon-pink), var(--neon-cyan), var(--neon-purple));
      opacity: 0.7;
      pointer-events: none;
      user-select: none;
    }

    .project-content {
      padding: 1.5rem;
      padding-top: 1.75rem;
    }

    .project-header {
      margin-bottom: 1rem;
    }

    .project-title {
      margin: 0 0 0.75rem 0;
      font-size: 1.3rem;
      font-weight: 600;
      font-family: 'Orbitron', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .project-title a {
      color: var(--theme-text);
      text-decoration: none;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }

    .project-title a:hover {
      color: var(--neon-cyan);
      text-shadow: 0 0 10px var(--neon-cyan);
    }

    /* Focus state - uses pink to differentiate from hover */
    .project-title a:focus-visible {
      outline: none;
      color: var(--neon-pink);
      text-shadow: 0 0 10px var(--neon-pink);
    }

    .external-icon {
      font-size: 0.8em;
      opacity: 0.7;
    }

    .project-meta {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .project-category {
      background: rgba(0, 217, 255, 0.1);
      border: 1px solid var(--neon-cyan);
      color: var(--neon-cyan);
      padding: 0.2rem 0.6rem;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .project-status {
      background: rgba(199, 163, 255, 0.1);
      border: 1px solid var(--neon-purple);
      color: var(--neon-purple);
      padding: 0.2rem 0.6rem;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .project-description {
      margin: 0 0 1rem 0;
      color: var(--theme-quote);
      font-style: italic;
      line-height: 1.6;
      font-size: 0.95rem;
    }

    .project-tags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      margin-bottom: 1rem;
    }

    .project-technologies {
      display: flex;
      flex-wrap: wrap;
      gap: 0.4rem;
      padding-top: 1rem;
      border-top: 1px solid rgba(255, 107, 157, 0.2);
    }

    .technology-tag {
      background: transparent;
      color: var(--neon-chartreuse);
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      font-size: 0.7rem;
      font-weight: 500;
      border: 1px solid rgba(218, 255, 1, 0.3);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Screen reader only */
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }

    @media (max-width: 768px) {
      .projects-page {
        padding: 0.5rem;
      }

      .projects-title {
        font-size: 2rem;
      }

      .projects-grid {
        grid-template-columns: 1fr;
      }

      .project-content {
        padding: 1.25rem;
      }
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
      .project-card {
        animation: none;
        opacity: 1;
      }

      .project-title a {
        transition: none;
      }

      .project-title a:hover,
      .project-title a:focus-visible {
        text-shadow: none;
      }
    }
  </style>
</PageLayout>

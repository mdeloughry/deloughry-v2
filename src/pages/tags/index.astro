---
import PageLayout from "@/layouts/Base";
import { getUniqueTagsWithCountFromTags, getTagSlug, formatTagForDisplay } from "@/utils";
import { getCollection } from "astro:content";

const allPosts = await getCollection("post");
const allTags = getUniqueTagsWithCountFromTags(allPosts.map(post => ({ tags: post.data.tags })));

const meta = {
	title: "All Tags",
	description: "All Tags from my blogs",
};
export const prerender = true;
---

<PageLayout meta={meta}>
	<div class="tags-page">
		<header class="tags-header">
			<h1 class="tags-title">Tags</h1>
			<p class="tags-subtitle">All tags from my blog posts</p>
		</header>

		<div class="tags-grid">
			{Object.entries(allTags).map(([tag, val]) => (
				<article class="tag-card">
					<a
						href={`/tags/${getTagSlug(tag)}`}
						title={`View posts with the tag: ${formatTagForDisplay(tag)}`}
						rel="prefetch"
						class="tag-link"
					>
						<h3 class="tag-name">#{formatTagForDisplay(tag)}</h3>
						<p class="tag-count">
							{val} Post{val > 1 ? "s" : ""}
						</p>
					</a>
				</article>
			))}
		</div>
	</div>

	<style>
		.tags-page {
			max-width: 1200px;
			margin: 0 auto;
			padding: 2rem;
		}

		.tags-header {
			text-align: center;
			margin-bottom: 3rem;
		}

		.tags-title {
			font-size: 3rem;
			font-weight: 700;
			margin-bottom: 1rem;
			color: var(--theme-text);
			font-family: 'Space Mono', monospace;
			text-transform: uppercase;
			letter-spacing: 1px;
		}

		.tags-subtitle {
			font-size: 1.2rem;
			color: var(--theme-quote);
			font-style: italic;
		}

		.tags-grid {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
			gap: 1.5rem;
		}

		.tag-card {
			background: var(--theme-bg);
			border-radius: 12px;
			overflow: hidden;
			box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
			transition: transform 0.3s ease, box-shadow 0.3s ease;
		}

		.tag-card:hover {
			transform: translateY(-4px);
			box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
		}

		.tag-link {
			display: block;
			padding: 1.5rem;
			text-decoration: none;
			color: inherit;
			text-align: center;
		}

		.tag-name {
			margin: 0 0 0.5rem 0;
			font-size: 1.2rem;
			font-weight: 600;
			color: var(--theme-accent);
			font-family: 'Space Mono', monospace;
			text-transform: uppercase;
			letter-spacing: 0.5px;
		}

		.tag-count {
			margin: 0;
			font-size: 0.9rem;
			color: var(--theme-quote);
			font-style: italic;
		}

		@media (max-width: 768px) {
			.tags-page {
				padding: 1rem;
			}

			.tags-title {
				font-size: 2rem;
			}

			.tags-grid {
				grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
				gap: 1rem;
			}

			.tag-link {
				padding: 1rem;
			}
		}
	</style>
</PageLayout>
